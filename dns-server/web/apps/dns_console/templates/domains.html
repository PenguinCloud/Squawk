[[extend 'layout.html']]

<div class="card">
    <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
        <h2 class="card-title">Domain Management</h2>
        <a href="[[=URL('domains/new')]]" class="btn btn-success">Add New Domain</a>
    </div>
    
    [[if domains:]]
    <table>
        <thead>
            <tr>
                <th>Domain Name</th>
                <th>Description</th>
                <th>Tokens with Access</th>
                <th>Created</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            [[for domain in domains:]]
            <tr>
                <td>
                    <strong>[[=domain.name]]</strong>
                    [[if domain.name == '*':]]
                        <span class="badge badge-success">Wildcard</span>
                    [[pass]]
                </td>
                <td>[[=domain.description or '']]</td>
                <td>
                    <span class="badge">[[=domain_stats.get(domain.id, 0)]] tokens</span>
                </td>
                <td>[[=domain.created_at.strftime('%Y-%m-%d') if domain.created_at else 'N/A']]</td>
                <td>
                    <a href="[[=URL('domains/edit', domain.id)]]" class="btn btn-sm">Edit</a>
                    <a href="[[=URL('domains/delete', domain.id)]]" class="btn btn-danger btn-sm" 
                       onclick="return confirm('Are you sure you want to delete this domain? This will remove all token permissions for this domain.');">Delete</a>
                </td>
            </tr>
            [[pass]]
        </tbody>
    </table>
    [[else:]]
    <p>No domains have been configured yet. <a href="[[=URL('domains/new')]]">Add your first domain</a>.</p>
    [[pass]]
</div>

<div class="card">
    <div class="card-header">
        <h2 class="card-title">Domain Guidelines</h2>
    </div>
    
    <ul style="line-height: 2;">
        <li>Use <code>*</code> as a wildcard domain to grant access to all domains</li>
        <li>Use specific domain names like <code>example.com</code> for precise control</li>
        <li>Subdomains are automatically included (e.g., <code>example.com</code> includes <code>sub.example.com</code>)</li>
        <li>Multiple tokens can have access to the same domain</li>
        <li>A token can have access to multiple domains</li>
    </ul>
</div>